
한 테이블 메타데이터 파일을 다른 테이블 메타데이터 파일로 원자적으로 교환하면 직렬화 가능한 격리의 기반이 제공됩니다. 리더는 테이블 메타데이터를 로드할 때 최신 상태였던 스냅샷을 사용하며, 새로 고침하고 새 메타데이터 위치를 선택할 때까지 변경 사항의 영향을 받지 않습니다.

작성자는 작성자의 커밋 전에 현재 버전이 변경되지 않을 것이라고 가정하고 낙관적으로 테이블 메타데이터 파일을 만듭니다. 작성자가 업데이트를 만든 후, 테이블의 메타데이터 파일 포인터를 기본 버전에서 새 버전으로 바꿔서 커밋합니다.

업데이트의 기반이 되는 스냅샷이 더 이상 최신이 아닌 경우 작성자는 새 최신 버전을 기반으로 업데이트를 다시 시도해야 합니다. 일부 작업은 잘 정의된 조건에서 메타데이터 변경 사항을 다시 적용하고 커밋하여 다시 시도하는 것을 지원합니다. 예를 들어, 파일을 다시 쓰는 변경 사항은 다시 쓴 모든 파일이 여전히 테이블에 있는 경우 새 테이블 스냅샷에 적용될 수 있습니다.

쓰기가 성공적으로 커밋하는 데 필요한 조건은 격리 수준을 결정합니다. 작성자는 무엇을 검증할지 선택하고 다양한 격리 보장을 할 수 있습니다.

# 참고 
+ [Iceberg optimistic-concurrency](https://iceberg.apache.org/spec/#optimistic-concurrency)